<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Camel K in Tekton Pipelines :: Apache Camel</title>
    <link rel="canonical" href="https://camel.apache.org/camel-k/latest/tutorials/tekton/tekton.html">
    <meta name="generator" content="Antora 3.0.0-alpha.9">
    <link rel="stylesheet" href="../../../../_/css/site-a192e92461.css">
<meta name="application-name" content="Apache Camel">
<meta property="og:title" content="Apache Camel helps you integrate over 300 different systems!">
<meta property="og:site_name" content="Apache Camel">
<meta property="og:url" content="https://camel.apache.org">
<meta property="og:description" content="Camel is an open source integration framework that empowers you to quickly and easily integrate various systems consuming or producing data.">
<meta property="og:type" content="website">
<meta property="og:image" content="https://camel.apache.org/_/img/logo-d.svg">
<link rel="manifest" href="../../../../site.webmanifest">
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../../../apple-touch-icon-57x57.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../../apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../../apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../../apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../../../apple-touch-icon-60x60.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../apple-touch-icon-152x152.png">
<link rel="icon" type="image/png" href="../../../../favicon-196x196.png" sizes="196x196">
<link rel="icon" type="image/png" href="../../../../favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../../favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../../favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="../../../../favicon-128.png" sizes="128x128">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="nav-logo" href="../../../.."></a>
      <div id="topbar-nav" class="navbar-menu">
        <div class="navbar-end">
                <a class="navbar-item-section navbar-item navbar-topics" href="../../../../blog/">
                  <img alt="ブログ" src="/_/img/blog.svg">
                  ブログ
                </a>
                <a class="navbar-item-section navbar-item navbar-topics" href="../../../../docs/">
                  <img alt="ドキュメント" src="/_/img/documentation.svg">
                  ドキュメント
                </a>
                <a class="navbar-item-section navbar-item navbar-topics" href="../../../../community/">
                  <img alt="コミュニティ" src="/_/img/community.svg">
                  コミュニティ
                </a>
                <a class="navbar-item-section navbar-item navbar-topics" href="../../../../download/">
                  <img alt="ダウンロード" src="/_/img/download.svg">
                  ダウンロード
                </a>
        </div>
      </div>
      <div class="navbar-fill"></div>
      <div class="break-row"></div>
      <div class="navbar-search results-hidden">
        <input id="search" class="search" placeholder="Search" autocomplete="off">
        <img src= "/_/img/cancel.svg" alt="Clear" id="search-cancel">
        <div id="search_results"></div>
      </div>
      <div class="navbar-tools">
        <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg focusable="false" class="brand-icon"><use xlink:href="../../../../_/img/brand-logos.svg#github" /></svg></a>
        <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg focusable="false" class="brand-icon"><use xlink:href="../../../../_/img/brand-logos.svg#zulip" /></svg></a>
        <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg focusable="false" class="brand-icon"><use xlink:href="../../../../_/img/brand-logos.svg#twitter" /></svg></a>
      </div>
      <button class="navbar-burger" data-target="topbar-nav" type="button" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>
</header>
<a id="top"></a>
<div class="body">
<div class="nav-container" data-component="camel-k" data-version="1.4.x">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active">
  <nav class="nav-menu" data-panel="menu">
    <h3 class="title"><a href="../../index.html">Camel K</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../installation/installation.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/minikube.html">Minikube</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/minishift.html">Minishift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/digitalocean.html">DigitalOcean Kubernetes Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/gke.html">Google Kubernetes Engine (GKE)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/openshift.html">OpenShift</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation/iks.html">IBM Kubernetes Service (IKS)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../installation/registry/registry.html">Configuring Registry</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation/registry/digitalocean.html">DigitalOcean</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation/registry/dockerhub.html">Docker Hub</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation/registry/github.html">Github Packages</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation/registry/gcr.html">Gcr.io</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation/registry/icr.html">IBM Container Registry</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../running/running.html">Running</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../running/dev-mode.html">Dev Mode</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../running/run-from-github.html">Run from GitHub</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../tutorials.html">Tutorials</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../cli/cli.html">CLI</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../cli/modeline.html">Modeline</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../configuration/configuration.html">Configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../configuration/maven.html">Maven</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../configuration/components.html">Components</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../configuration/dependencies.html">Dependencies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../configuration/configmap-secret.html">ConfigMap/Secret</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <span class="nav-text">Observability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../observability/monitoring.html">Monitoring</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../observability/operator.html">Operator</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../observability/integration.html">Integration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <span class="nav-text">Scaling</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../scaling/integration.html">Integration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../traits/traits.html">Traits</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/3scale.html">3scale</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/affinity.html">Affinity</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/builder.html">Builder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/camel.html">Camel</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/container.html">Container</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/cron.html">Cron</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/dependencies.html">Dependencies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/deployer.html">Deployer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/deployment.html">Deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/environment.html">Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/error-handler.html">Error Handler</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/gc.html">Gc</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/ingress.html">Ingress</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/istio.html">Istio</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/jolokia.html">Jolokia</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/jvm.html">Jvm</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/kamelets.html">Kamelets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/knative-service.html">Knative Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/knative.html">Knative</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/master.html">Master</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/openapi.html">Openapi</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/owner.html">Owner</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/pdb.html">Pdb</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/platform.html">Platform</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/prometheus.html">Prometheus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/pull-secret.html">Pull Secret</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/quarkus.html">Quarkus</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/route.html">Route</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/service-binding.html">Service Binding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/service.html">Service</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/toleration.html">Toleration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../traits/tracing.html">Tracing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <span class="nav-text">Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/debugging.html">Debugging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/operating.html">Operating</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/known-issues.html">Known Issues</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../kamelets/kamelets.html">Kamelets</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../kamelets/kamelets-user.html">Kamelets User Guide</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../kamelets/kamelets-dev.html">Kamelets Developer Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../architecture/architecture.html">Architecture</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../architecture/operator.html">Operator</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../architecture/cr/integration-platform.html">IntegrationPlatform</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../architecture/cr/integration.html">Integration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../architecture/cr/integration-kit.html">IntegrationKit</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../architecture/cr/build.html">Build</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../architecture/cr/camel-catalog.html">CamelCatalog</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../architecture/runtime.html">Runtime</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../architecture/traits.html">Traits</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../architecture/sources.html">Sources</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../uninstalling.html">Uninstalling</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Expand or contract topic"></button>
    <a class="nav-link" href="../../contributing/developers.html">Contributing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../contributing/local-development.html">Local development</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../contributing/local-deployment-olm.html">Local OLM deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../contributing/e2e.html">Local E2E testing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Camel K</span>
    <span class="version">1.4.x</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">User manual</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../../manual/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Camel Components</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../../components/latest/index.html">3.12.0 (Prerelease)</a>
        </li>
        <li class="version">
          <a href="../../../../components/3.11.x/index.html">3.11.x (LTS)</a>
        </li>
        <li class="version">
          <a href="../../../../components/3.7.x/index.html">3.7.x (LTS)</a>
        </li>
        <li class="version">
          <a href="../../../../components/2.x/index.html">2.x</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Camel K</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../latest/index.html">latest</a>
        </li>
        <li class="version is-current">
          <a href="../../index.html">1.4.x</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Camel Kafka Connector</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../../camel-kafka-connector/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../camel-kafka-connector/0.7.x/index.html">0.7.x</a>
        </li>
        <li class="version">
          <a href="../../../../camel-kafka-connector/0.4.x/index.html">0.4.x</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Kamelet Catalog</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../../camel-kamelets/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Camel Karaf</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../../camel-karaf/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../camel-karaf/3.11.x/index.html">3.11.x (LTS)</a>
        </li>
        <li class="version">
          <a href="../../../../camel-karaf/3.7.x/index.html">3.7.x (LTS)</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Camel Quarkus</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../../camel-quarkus/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../camel-quarkus/2.0.0/index.html">2.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Camel Spring Boot</span>
      <ul class="versions">
        <li class="version">
          <a href="../../../../camel-spring-boot/latest/index.html">latest</a>
        </li>
        <li class="version">
          <a href="../../../../camel-spring-boot/3.11.x/index.html">3.11.x (LTS)</a>
        </li>
        <li class="version">
          <a href="../../../../camel-spring-boot/3.7.x/index.html">3.7.x (LTS)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<nav class="toolbar">
<button class="nav-toggle" aria-label="Toggle submenu"></button>
  <a href="../../../../manual/latest/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Camel K</a></li>
    <li><a href="tekton.html">Camel K in Tekton Pipelines</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.4.x</button>
  <div class="version-menu">
    <a class="version" href="../../../latest/tutorials/tekton/tekton.html">latest</a>
    <a class="version is-current" href="tekton.html">1.4.x</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/apache/camel-k/edit/release-1.4.x/docs/modules/ROOT/pages/tutorials/tekton/tekton.adoc">Edit this Page</a></div>
  </nav>
  <div class="content">
<article class="doc">
<h1 class="page">Camel K in Tekton Pipelines</h1>
<div class="sect1">
<h2 id="tutorials-tekton-introduction"><a class="anchor" href="#tutorials-tekton-introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<div class="table-wrapper"><table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Available from Camel K 1.0.0-M2
</td>
</tr>
</table></div>
</div>
<div class="paragraph">
<p>Camel K can be directly used in <a href="https://github.com/tektoncd/pipeline">Tekton Pipelines</a> tasks since it&#8217;s container image ships the <code>kamel</code> CLI tool, that
can be used to create all needed resources by interacting with the Kubernetes cluster.</p>
</div>
<div class="paragraph">
<p>For example, the following Tekton pipeline task can be used to run an integration:</p>
</div>
<div id="camel-k-task-run-integration" class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: camel-k-run-integration
spec:
  inputs:
    resources:
      - name: repository
        type: git
    params:
      - name: file
        description: The integration file to run
  steps:
    - name: run-integration
      image: apache/camel-k:1.0.0-M2 <i class="conum" data-value="1"></i><b>(1)</b>
      workingDir: /workspace/repository
      command:
        - kamel
      args:
        - "run"
        - "--wait"
        - "$(inputs.params.file)" <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<div class="table-wrapper"><table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The base image for the step is <code>apache/camel-k:1.0.0-M2</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>It executes command <code>kamel run --wait ${inputs.params.file}</code>, with file to run received as parameter</td>
</tr>
</table></div>
</div>
<div class="paragraph">
<p>When executed, such task creates an integration resource from the given file (which is supposed to be contained in the input git repository) and waits for the integration to be fully running before completing.</p>
</div>
<div class="paragraph">
<p>This task is a building block for more complex scenarios that can be composed in Tekton pipelines.
If you want to learn more, just follow the remainder of the tutorial.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tutorials-tekton-prerequisites"><a class="anchor" href="#tutorials-tekton-prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial assumes the following requirements are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OpenShift (or OKD) 4+ cluster (works also on "vanilla" Kubernetes with some adjustment) and <code>oc</code> binary tool</p>
</li>
<li>
<p>Tekton Pipelines 0.5.2 (different versions may need adjustments)</p>
</li>
<li>
<p>Camel K Client Tools 1.0.0-M2 (<code>kamel</code> binary tool)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tutorials-tekton-cluster-setup"><a class="anchor" href="#tutorials-tekton-cluster-setup"></a>Cluster Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial assumes that <strong>Tekton Pipelines are already installed</strong> in the cluster. Refer to the <a href="https://github.com/tektoncd/pipeline">Tekton documentation</a>
to learn how to install them.</p>
</div>
<div class="paragraph">
<p>Camel K cluster resources need to be installed on the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Use the oc tool to login as cluster admin to the target cluster, then
kamel install --cluster-setup</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will install the Camel K CRD (custom resource definitions) and roles to access them.
You can switch to a standard user after doing this operation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tutorials-tekton-creating-the-pipeline"><a class="anchor" href="#tutorials-tekton-creating-the-pipeline"></a>Creating the Pipeline</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We&#8217;re going to create a pipeline on a new namespace. The first step is to create the namespace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc new-project camel-pipelines</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_setting_up_a_serviceaccount"><a class="anchor" href="#_setting_up_a_serviceaccount"></a>Setting up a ServiceAccount</h3>
<div class="paragraph">
<p>Any running container that needs to interact with the Kubernetes API (in our case, to create deployment and integration resources) must
have special permissions granted to its service account.</p>
</div>
<div class="paragraph">
<p>Download the <a href="../../_attachments/tekton/camel-k-pipeline-permissions.yaml">camel-k-pipeline-permissions.yaml</a> file and save it into a directory in your hard drive.
Then install it using the <code>oc</code> client tool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f camel-k-pipeline-permissions.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a <a href="https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/">Kubernetes ServiceAccount</a> named <code>camel-k-pipeline</code>
that is authorized to create the same kind of resources that the Camel K operator needs to create. We&#8217;ll use that service account to run our pipeline.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_the_pipeline_definition"><a class="anchor" href="#_creating_the_pipeline_definition"></a>Creating the Pipeline Definition</h3>
<div class="paragraph">
<p>Let&#8217;s now create the pipeline definition. Download the <a href="../../_attachments/tekton/camel-k-pipeline-task-definition.yaml">camel-k-pipeline-task-definition.yaml</a> file
and apply it to the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f camel-k-pipeline-task-definition.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a series of resources, including a pipeline definition that you can immediately see on the OpenShift developer console.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tekton/tekton-pipeline-definition.png" alt="View of the Camel K Tekton pipeline in the OpenShift developer console">
</div>
</div>
<div class="paragraph">
<p>The pipeline just created is composed of two tasks.</p>
</div>
<div class="paragraph">
<p>The last task (<code>camel-k-run-integration</code>) is the one we&#8217;ve <a href="#camel-k-task-run-integration">already described in the introduction</a>, while the first task just installs the operator in the current namespace.
The definition of the first task is shown in the following excerpt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: camel-k-install-operator
spec:
  steps:
    - name: install
      image: apache/camel-k:1.0.0-M2
      command:
        - kamel
      args:
        - "install"
        - "--skip-cluster-setup"</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you see, it&#8217;s just doing a <code>kamel install --skip-cluster-setup</code> (we&#8217;ve already done the cluster setup in the <a href="#tutorials-tekton-cluster-setup">preparation phase</a>).</p>
</div>
<div class="paragraph">
<p>Both tasks are executed in sequence in the pipeline that is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: tekton.dev/v1alpha1
kind: Pipeline
metadata:
  name: camel-k-pipeline
spec:
  resources:
    - name: source-repo
      type: git
  tasks:
    - name: install-operator
      taskRef:
        name: camel-k-install-operator
    - name: run-integration
      runAfter: [install-operator]
      taskRef:
        name: camel-k-run-integration
      resources:
        inputs:
          - name: repository
            resource: source-repo
      params:
        - name: file
          value: "examples/tekton/hello.groovy"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The integration file to be executed is set to <code>examples/tekton/hello.groovy</code> that is a simple "Hello World" integration contained in the Camel K
github repository <a href="https://github.com/apache/camel-k/tree/master/example/tekton">example/tekton directory</a>.</p>
</div>
<div class="paragraph">
<p>In order to specify the actual source repository, the definition file contains also the following resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: tekton.dev/v1alpha1
kind: PipelineResource
metadata:
  name: camel-k-examples-git
spec:
  type: git
  params:
    - name: revision
      value: master
    - name: url
      value: https://github.com/apache/camel-k</code></pre>
</div>
</div>
<div class="paragraph">
<p>The repo will be now used as input for the <a href="#camel-k-task-run-integration">run-integration task</a> in the pipeline.</p>
</div>
</div>
<div class="sect2">
<h3 id="_triggering_a_pipeline_execution"><a class="anchor" href="#_triggering_a_pipeline_execution"></a>Triggering a Pipeline Execution</h3>
<div class="paragraph">
<p>Everything is now ready to be executed and the last thing missing is a trigger. Download the <a href="../../_attachments/tekton/camel-k-pipeline-task-run.yaml">camel-k-pipeline-task-run.yaml</a> file
and apply it to the cluster:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f camel-k-pipeline-task-run.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The file contains only a PipelineRun resource:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: tekton.dev/v1alpha1
kind: PipelineRun
metadata:
  name: camel-k-pipeline-run-1
spec:
  pipelineRef:
    name: camel-k-pipeline
  serviceAccount: 'camel-k-pipeline' <i class="conum" data-value="1"></i><b>(1)</b>
  resources:
    - name: source-repo
      resourceRef:
        name: camel-k-examples-git <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<div class="table-wrapper"><table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The PipelineRun binds the pipeline to the service account previously created</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>It also binds the pipeline to the Camel K repository containing the examples</td>
</tr>
</table></div>
</div>
<div class="paragraph">
<p>The creation of the file starts the execution of the pipeline and its progress can be monitored on the OpenShift developer console.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tekton/tekton-pipeline-run.png" alt="View of the Camel K Tekton pipeline execution in the OpenShift developer console">
</div>
</div>
<div class="admonitionblock caution">
<div class="table-wrapper"><table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
To execute the PipelineRun again, delete previous runs before re-applying
</td>
</tr>
</table></div>
</div>
<div class="paragraph">
<p>The result of the pipeline execution is the Camel K operator and an integration named <code>hello</code> running on the cluster:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/tekton/tekton-pipeline-result.png" alt="Result of the Camel K Tekton pipeline execution">
</div>
</div>
<div class="paragraph">
<p>There are certainly other ways to trigger an execution of a pipeline, like as reaction to a change in the git repository,
but this is left to you as exercise ;)</p>
</div>
<div class="paragraph">
<p>Refer to the <a href="https://github.com/tektoncd/pipeline">Tekton repository</a> for more information.</p>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
    <div class="footer-tools">
        <a href="#top" title="Reach the top of the page">Back to top</a>
    </div>
    <footer>
        <div class="footer">
            <figure class="logo">
                <img src="../../../../_/img/logo-d.svg" class="logo-small mt-60" alt="Apache Camel Logo"
                    aria-label="white silhouette of a camel in front of a sand dune">
            </figure>
            <input id="footer-toggle-overview" type="checkbox" title="Show/Hide Overview section" />
            <dl>
                <dt><label for="footer-toggle-overview">Overview</label><label for="footer-toggle-overview">&#65291;</label></dt>
                <dd><a href="../../../../blog/">Blog</a></dd>
                <dd><a href="../../../../docs/">Documentation</a></dd>
                <dd><a href="../../../../community/support/">Community</a></dd>
                <dd><a href="../../../../download/">Download</a></dd>
            </dl>
            <input id="footer-toggle-documentation" type="checkbox" title="Show/Hide Documentation section" />
            <dl>
                <dt><label for="footer-toggle-documentation">Documentation</label><label for="footer-toggle-documentation">&#65291;</label></dt>
                <dd><a href="../../../../manual/latest/">User Manual</a></dd>
                <dd><a href="../../../../components/latest/index.html">Components</a></dd>
                <dd><a href="../../../../camel-k/latest/">Camel-K</a></dd>
                <dd><a href="../../../../camel-kafka-connector/latest/">Camel Kafka Connector</a></dd>
                <dd><a href="../../../../camel-quarkus/latest/">Camel Quarkus</a></dd>
                <dd><a href="../../../../camel-spring-boot/latest/">Camel Spring Boot</a></dd>
                <dd><a href="../../../../camel-karaf/latest/">Camel Karaf</a></dd>
                <dd><a href="../../../../manual/latest/faq/index.html">FAQ</a></dd>
            </dl>
            <input id="footer-toggle-community" type="checkbox" title="Show/Hide Community section" />
            <dl>
                <dt><label for="footer-toggle-community">Community</label><label for="footer-toggle-community">&#65291;</label></dt>
                <dd><a href="../../../../community/support/">Support</a></dd>
                <dd><a href="../../../../community/contributing/">Contributing</a></dd>
                <dd><a href="../../../../community/mailing-list/">Mailing Lists</a></dd>
                <dd><a href="../../../../community/user-stories/">User stories</a></dd>
                <dd><a href="../../../../community/articles/">Articles</a></dd>
                <dd><a href="../../../../community/books/">Books</a></dd>
                <dd><a href="../../../../community/team/">Team</a></dd>
            </dl>
            <input id="footer-toggle-about" type="checkbox" title="Show/Hide Acknowledgements section" />
            <dl>
                <dt><label for="footer-toggle-about">About</label><label for="footer-toggle-about">&#65291;</label></dt>
                <dd><a href="../../../../acknowledgments/">Acknowledgments</a></dd>
                <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/events/current-event.html" title="Apache Events">Apache Events</a></dd>
                <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/licenses/" title="License">License</a></dd>
                <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/security/" title="Security">Security</a></dd>
                <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/sponsorship.html" title="Sponsorship">Sponsorship</a></dd>
                <dd><a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/thanks.html" title="Thanks">Thanks</a></dd>
            </dl>
            <p class="remark">
                &copy; 2004-2021 The <a href="https://apache.org">Apache Software Foundation</a>.<br>
                Apache Camel, Camel, Apache, the Apache feather logo, and the Apache Camel project logo are trademarks of
                The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of
                their respective owners.
            </p>
            <div class="resources">
                <div class="context">
                    <a href="../../../../privacy-policy/">Privacy Policy</a>
                </div>
                <div class="context">
                    <a target="_blank" rel="noopener noreferrer nofollow" href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a>
                </div>
                <div class="context">
                    <a href="../../../../sitemap/">Sitemap</a>
                </div>
            </div>
            <div class="footer-icons">
                <a rel="noopener noreferrer nofollow" href="https://github.com/apache/camel/" title="Collaborate on GitHub"><svg class="brand-icon" focusable="false"><use xlink:href="../../../../_/img/brand-logos.svg#github" /></svg></a>
                <a rel="noopener noreferrer nofollow" href="https://camel.zulipchat.com" title="Chat on Zulip"><svg class="brand-icon" focusable="false"><use xlink:href="../../../../_/img/brand-logos.svg#zulip" /></svg></a>
                <a rel="noopener noreferrer nofollow" href="https://twitter.com/ApacheCamel" title="Follow Apache Camel on Twitter"><svg class="brand-icon" focusable="false"><use xlink:href="../../../../_/img/brand-logos.svg#twitter" /></svg></a>
            </div>
        </div>
    </footer>
<script src="../../../../_/js/vendor/algoliasearch-8fe81df376.js"></script>
<script src="../../../../_/js/site-0d18f68ee9.js"></script>
<script async src="../../../../_/js/vendor/highlight-a988c6fdd9.js"></script>
<script async src="../../../../_/js/vendor/svg4everybody-195d47ce7d.js"></script>
        <script type='application/ld+json'>
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "Apache Camel",
  "url": "https://camel.apache.org",
  "sameAs": [
     "https://twitter.com/ApacheCamel"
  ],
  "logo": "../../../../_/img/logo-d.svg",
  "description": "Apache Camel ™ is a versatile open-source integration framework based on known Enterprise Integration Patterns. Camel empowers you to define routing and mediation rules in a variety of domain-specific languages, including a Java-based Fluent API, Spring or Blueprint XML Configuration files, and a Scala DSL."
}
</script>
    <script type="application/ld+json">
    {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Apache Camel",
        "item": "https://camel.apache.org/"
        },
        {
        "@type": "ListItem",
        "position": 2,
        "name": "Camel K",
        "item": "https://camel.apache.org/camel-k/latest/index.html"
        },
        {
        "@type": "ListItem",
        "position": 3,
        "name": "1.4.x",
        "item": "https://camel.apache.org/camel-k/1.4.x/index.html"
        },
        {
        "@type": "ListItem",
        "position": 4,
        "name": "Camel K in Tekton Pipelines",
        "item": "https://camel.apache.org/camel-k/1.4.x/tutorials/tekton/tekton.html"
        }]
    }
</script>

  </body>
</html>
